
{% extends 'pricing/spark_base.html' %}

{% block title %}Pricing Stats - {{location}} - All Categories{% endblock %}


{% block header_title %}Pricing - Stats  - {{location}}{% endblock %}


{% block active_link %}

{% endblock %}

{% block content %}
<style>
.table-preview {
  max-height: 280px;
  overflow-y: auto;
  overflow-x: hidden;
}
.table-preview table {
  margin-bottom: 0;
}
.stat-grid {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
  gap: 1rem;
  margin-bottom: 2rem;
}
.stat-card {
  padding: 1.25rem;
  min-height: 150px;
  display: flex;
  flex-direction: column;
  justify-content: space-between;
  border: 1px solid #e5e7eb;
  border-radius: 12px;
  box-shadow: 0 8px 20px rgba(15, 23, 42, 0.07);
}
.stat-label {
  text-transform: uppercase;
  font-size: 0.8rem;
  letter-spacing: 0.15em;
  color: #64748b;
  margin-bottom: 0.5rem;
}
.stat-value {
  font-size: 2rem;
  font-weight: 600;
  margin: 0;
}
.stat-caption {
  margin: 0;
  color: #475569;
  font-size: 0.9rem;
}
.category-reference-wrap {
  overflow-x: auto;
  margin-bottom: 1.5rem;
}
.category-grid {
  display: grid;
  grid-template-columns: repeat(7, minmax(130px, 1fr));
  gap: 0.75rem;
  min-width: 910px;
}
.category-card {
  border: 1px solid #e5e7eb;
  border-radius: 8px;
  padding: 0.65rem 0.45rem;
  background: #fff;
  box-shadow: 0 4px 12px rgba(15, 23, 42, 0.04);
}
.category-card:hover {
  box-shadow: 0 6px 16px rgba(15, 23, 42, 0.08);
}
.category-card h6 {
  display: flex;
  align-items: center;
  font-weight: 600;
  font-size: 0.82rem;
  margin-bottom: 0.4rem;
  color: inherit;
}
.category-card h6 i {
  margin-right: 0.35rem;
}
.category-items {
  display: flex;
  flex-direction: column;
  gap: 0.2rem;
}
.category-badge {
  border-radius: 12px;
  padding: 0.2rem 0.3rem;
  font-size: 0.74rem;
  border: 1px solid rgba(15, 23, 42, 0.08);
  white-space: nowrap;
}
.category-card.books { background: #fff4e6; color: #b45309; }
.category-card.building { background: #f5f0e8; color: #8c5a2b; }
.category-card.electronics { background: #e6f3ff; color: #0369a1; }
.category-card.computers { background: #f0edff; color: #5b21b6; }
.category-card.furniture { background: #e6f9f5; color: #0f766e; }
.category-card.housewares { background: #ffe9ec; color: #b91c1c; }
.category-card.textiles { background: #f5ebff; color: #7e22ce; }
</style>
<!-- QueryBox -->
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-body">
      <form method="GET">
        <p>Please select the date range:</p>
        <div class="row">
          <!-- <div class="row"> -->
          <div class="col">
            <div class="form-group">
    					<!-- <label class="form-label">Start Date</label> -->
              <input class="form-control" type="date" name="start" value="{{start_date}}">
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <input class="form-control" type="date" name="end" value="{{end_date}}">
            </div>
          </div>
          <div class="col">
            <div class="form-group">
              <button class="form-control btn btn-primary btn-md" type="submit">SUBMIT</button>
            </div>
          </div>
  			</div>
      </form>
      </div>
    </div>
  </div>
</div>


<!-- stats toolbar -->
<div class="stat-grid">
  <div class="stat-card">
    <p class="stat-label">Total Pricing Value</p>
    <p class="stat-value">${{total_pricing_value | floatformat:2}}</p>
    <p class="stat-caption">Total value of priced goods</p>
  </div>
  <div class="stat-card">
    <p class="stat-label">Total Items</p>
    <p class="stat-value">{{total_items}}</p>
    <p class="stat-caption">Total number of items priced</p>
  </div>
  <div class="stat-card">
    <p class="stat-label">Total Submissions</p>
    <p class="stat-value">{{pricing_submissions}}</p>
    <p class="stat-caption">Number of pricing submissions</p>
  </div>
  <div class="stat-card">
    <p class="stat-label">Avg Item Price</p>
    <p class="stat-value">${{avg_item_price | floatformat:2}}</p>
    <p class="stat-caption">Average price per item</p>
  </div>
  <div class="stat-card">
    <p class="stat-label">Items per Submission</p>
    <p class="stat-value">{{items_per_submission | floatformat:2}}</p>
    <p class="stat-caption">Average items per submission</p>
  </div>
</div>



<div class="card mb-4">
  <div class="card-header">
    <h5 class="card-title mb-0">Category Reference</h5>
  </div>
  <div class="card-body category-reference-wrap">
    <div class="category-grid">
      <div class="category-card books">
        <h6><i class="fas fa-book"></i>Books & Media</h6>
        <div class="category-items">
          <span class="category-badge">Books</span>
          <span class="category-badge">Movies</span>
          <span class="category-badge">Music</span>
        </div>
      </div>
      <div class="category-card building">
        <h6><i class="fas fa-hammer"></i>Building Materials & Tools</h6>
        <div class="category-items">
          <span class="category-badge">Building Materials</span>
          <span class="category-badge">Doors/Windows</span>
          <span class="category-badge">Lighting</span>
          <span class="category-badge">Lumber</span>
          <span class="category-badge">Tools</span>
        </div>
      </div>
      <div class="category-card electronics">
        <h6><i class="fas fa-plug"></i>Electronics</h6>
        <div class="category-items">
          <span class="category-badge">Electronics</span>
        </div>
      </div>
      <div class="category-card computers">
        <h6><i class="fas fa-desktop"></i>Computers & Peripherals</h6>
        <div class="category-items">
          <span class="category-badge">Desktop</span>
          <span class="category-badge">Laptop</span>
          <span class="category-badge">Peripherals</span>
          <span class="category-badge">Tablet</span>
          <span class="category-badge">Smartphone</span>
          <span class="category-badge">Other Computer</span>
        </div>
      </div>
      <div class="category-card furniture">
        <h6><i class="fas fa-couch"></i>Furniture & Appliances</h6>
        <div class="category-items">
          <span class="category-badge">Appliances</span>
          <span class="category-badge">Furniture</span>
        </div>
      </div>
      <div class="category-card housewares">
        <h6><i class="fas fa-utensils"></i>Housewares</h6>
        <div class="category-items">
          <span class="category-badge">Housewares</span>
          <span class="category-badge">Holiday</span>
          <span class="category-badge">Jewelry</span>
          <span class="category-badge">Seasonal</span>
          <span class="category-badge">Bicycle</span>
          <span class="category-badge">Bicycle Parts</span>
        </div>
      </div>
      <div class="category-card textiles">
        <h6><i class="fas fa-tshirt"></i>Textiles</h6>
        <div class="category-items">
          <span class="category-badge">Accessories</span>
          <span class="category-badge">Clothing</span>
          <span class="category-badge">Linens</span>
          <span class="category-badge">Shoes</span>
        </div>
      </div>
    </div>
  </div>
</div>

<div class="row g-3">
  <div class="col-12">
    <div class="card">
      <div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">Breakdown by Category / Product Type</h5>
        <button type="button" class="btn btn-sm btn-outline-primary">Expand</button>
      </div>
      <div class="card-body table-responsive table-preview">
        <table class="table table-sm align-middle">
          <thead><tr>
            <th>Category</th>
            <th>PRODUCT TYPE</th>
            <th>Value</th>
            <th>Items</th>
            <th>Submissions</th>
            <th>Avg. Submission Price</th>
            <th>Items/Submission</th>
          </tr></thead>
          <tbody>
            {% for i in PT %}
              <tr>
                <td>{{i.CAT}}</td>
                <td>{{i.PT}}</td>
                <td>${{i.PRICING_VALUE | floatformat:2}}</td>
                <td>{{i.TOTAL_ITEMS}}</td>
                <td>{{i.COUNT}}</td>
                <td>{{i.AVG | floatformat:2}}</td>
                <td>{{i.ITEM_SUBMISSIONS | floatformat:2}}</td>
              </tr>
            {% endfor %}
          </tbody></table>
      </div>
    </div>
  </div>
</div>
<!-- STAFF BREADKLDOWN -->
<div class="row g-3 mt-1">
  <div class="col-12">
    <div class="card">
    	<div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">Breakdown by Staff ID</h5>
        <button type="button" class="btn btn-sm btn-outline-primary">Expand</button>
    	</div>
    	<div class="card-body table-responsive table-preview">
        <table class="table table-sm align-middle">
          <thead><tr>
            <th>Staff ID</th>
            <th>Value</th>
            <th>Items</th>
            <th>Submissions</th>
            <th>Avg. Price*</th>
            <th>Items/Submission</th>
          </tr></thead>
          <tbody>
            {% for i in ST %}
              <tr>
                <td>{{i.ST}}</td>
                <td>${{i.PRICING_VALUE | floatformat:2}}</td>
                <td>{{i.TOTAL_ITEMS}}</td>
                <td>{{i.COUNT}}</td>
                <td>{{i.AVG | floatformat:2}}</td>
                <td>{{i.ITEM_SUBMISSIONS | floatformat:2}}</td>
              </tr>
            {% endfor %}
          </tbody></table>

    	</div>
    </div>
  </div>
</div>

<!-- BY DATE -->
<div class="row g-3 mt-1">
  <div class="col-12">
    <div class="card">
    	<div class="card-header d-flex justify-content-between align-items-center">
        <h5 class="card-title mb-0">Datewise Breakdown by Product Type</h5>
        <button type="button" class="btn btn-sm btn-outline-primary">Expand</button>
    	</div>
    	<div class="card-body table-responsive table-preview">
        <table class="table table-sm align-middle">
          <thead><tr>
            {% for i in cats%}
            <th>{{i}}</th>
            {% endfor %}
          </tr></thead>
          <tbody>
            {% for i in DT %}
              <tr>
                  {% for j in i.values %}
                    <td>{{j}}</td>
                  {% endfor %}
              </tr>
            {% endfor %}
          </tbody>
        </table>
    	</div>
    </div>
  </div>
</div>

{% endblock %}



{% block javascript_end %}{% endblock %}
